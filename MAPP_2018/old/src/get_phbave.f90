PROGRAM get_phbave
  
!to get domain average height phb for emissions processing
!input generated from
!ncwa -a south_north,west_east -v PHB wrfinput_enkf_d01_2012-06-05_06:00:00 phb_ave.nc
!for 24km domain
  
  IMPLICIT NONE
  
  INTEGER, PARAMETER :: nlevs = 41,grav=9.81
  
  REAL, DIMENSION(nlevs) :: phb
  
  INTEGER :: k

!12km domain 
  phb=(/1899.84, 2214.98, 2531.102, 2848.242, 3246.068, 3645.458, 4287.84,  &
       4934.453, 5748.483, 6569.527, 7397.221, 8399.489, 9412.143, 10692.84, &
       11990.13, 13304.69, 14637.36, 15987.83, 17818.76, 19684.6, 21586.34, &
       23526.59, 26008.15, 29073.18, 32777.42, 37195.48, 41832.38, 46710.4, &
       52525.77, 58736.48, 65406.14, 72617.62, 81394.12, 91171.92, 102244.1, &
       115057.4, 130374.3, 145343.3, 159019, 172943.4, 185183.1 /)

!  GOTO 100
  
!24km domain
  phb=(/1899.84, 2057.281, 2372.931, 2689.562, 3086.765, 3485.516, 4126.875,  &
       4772.452, 5585.156, 6404.682, 7231.101, 8231.782, 9242.694, 10520.95, &
       11815.99, 13128.45, 14458.37, 15807.06, 17634.19, 19496.26, 21394.54, &
       23330.98, 25806.99, 28348.61, 31491.24, 34740.15, 38678.32, 43389.88, &
       48352.63, 53598.93, 59164.43, 66646.38, 74813.82, 83829.27, 93910.2, &
       105382.5, 115892.3, 128026.8, 142474.2, 160564.5, 185400.3 /)

100 CONTINUE

  DO k=2,nlevs
     phb(k)=(phb(k)-phb(1))/grav
     PRINT *,phb(k)
  ENDDO

  phb(1)=0.
  
END PROGRAM get_phbave



    

